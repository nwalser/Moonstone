<MudGrid Spacing="1">
    @foreach (var dailyAllocationRule in Database.Enumerate<WeeklyWorkDay>()
                  .Where(w => w.WorkerId == Worker.Id)
                  .Where(w => w.ActiveFrom.Year <= Year)
                  .Where(w => w.ActiveTo.Year >= Year))
    {
        <MudItem sm="12">
            <MudPaper Outlined="true" Class="pa-3" @key="@dailyAllocationRule.GetHashCode()">
                <WeeklyWorkdayView WeeklyWorkDay="dailyAllocationRule" />
            </MudPaper>
        </MudItem>
    }

    <MudItem sm="12">
        <MudButton Variant="Variant.Outlined" Size="Size.Small" OnClick="@AddRule" Style="width: 100%">Add</MudButton>
    </MudItem>
</MudGrid>

@code {
    [CascadingParameter] public required ProjectDatabase Database { get; set; }
    
    [Parameter] public required WorkerAggregate Worker { get; set; }
    [Parameter] public required int Year { get; set; }

    private void AddRule()
    {
        var weeklyWorkDay = new WeeklyWorkDay
        {
            WorkerId = Worker.Id,
            ActiveFrom = new DateOnly(2000, 1, 1),
            ActiveTo = new DateOnly(2100, 1, 1),
            WorkingHours = TimeSpan.Zero,
            DayOfWeek = DayOfWeek.Monday
        };

        Database.Update(weeklyWorkDay);
    }
}